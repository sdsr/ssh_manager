# SSH Manager

다중 SSH 서버를 관리하고 동시에 작업할 수 있는 터미널 기반 도구입니다.

## 주요 기능

- **서버 관리**: IP, 사용자명, 비밀번호를 암호화하여 안전하게 저장
- **다중 연결**: 여러 서버에 동시 SSH 접속
- **명령 브로드캐스트**: 같은 명령을 모든 연결된 서버에 동시 실행
- **파일 전송**: 같은 파일을 여러 서버에 동시 업로드 (SFTP)
- **그룹 관리**: 서버를 그룹으로 분류하여 관리

## 설치

### 요구사항

- Ubuntu 18.04 이상 (또는 다른 Linux 배포판)
- Python 3.9 이상
- pip

### 설치 방법

```bash
# 1. 저장소 클론 또는 파일 복사
cd ssh_manager

# 2. 가상환경 생성 (권장)
python3 -m venv venv
source venv/bin/activate

# 3. 의존성 설치
pip install -r requirements.txt
```

## 사용법

### 실행

```bash
# 가상환경 활성화 (설치 시 생성한 경우)
source venv/bin/activate

# 실행
python run.py
```

### 처음 실행 시

1. 마스터 비밀번호 설정
   - 이 비밀번호는 서버 정보를 암호화하는 데 사용됩니다
   - **중요**: 비밀번호를 잊으면 저장된 서버 정보를 복구할 수 없습니다

### 메인 메뉴

```
[1] 서버 관리 (추가/수정/삭제)
[2] 서버 목록 보기
[3] 서버 연결
[4] 명령 실행 (연결된 서버에)
[5] 파일 전송 (연결된 서버에)
[6] 연결 해제
[q] 종료
```

### 서버 등록

1. 메인 메뉴에서 `1` 선택 -> `1` (서버 추가)
2. 서버 정보 입력:
   - 서버 이름 (별칭)
   - 호스트 (IP 주소 또는 도메인)
   - SSH 포트 (기본값: 22)
   - 사용자 이름
   - 비밀번호
   - 그룹 (선택, 기본값: default)
   - 설명 (선택)

### 서버 연결

1. 메인 메뉴에서 `3` 선택
2. 연결할 서버 선택:
   - 특정 서버: 번호 입력 (예: `1`)
   - 여러 서버: 쉼표로 구분 (예: `1,2,3`)
   - 전체 서버: `all` 입력

### 명령 실행 (브로드캐스트)

1. 서버에 연결된 상태에서 메인 메뉴 `4` 선택
2. 대상 서버 선택 (기본값: all)
3. 명령어 입력
4. 모든 선택된 서버에서 동시에 실행
5. 각 서버의 결과를 개별적으로 표시
6. `exit` 또는 빈 줄로 종료

예시:
```
$ hostname
$ df -h
$ free -m
$ uptime
```

### 파일 전송

1. 서버에 연결된 상태에서 메인 메뉴 `5` 선택
2. 업로드 또는 다운로드 선택
3. **업로드**: 로컬 파일을 여러 서버에 동시 전송
4. **다운로드**: 특정 서버에서 파일 다운로드

## 프로젝트 구조

```
ssh_manager/
├── run.py                  # 실행 스크립트
├── requirements.txt        # 의존성 목록
├── README.md              # 이 문서
└── ssh_manager/           # 메인 패키지
    ├── __init__.py
    ├── main.py            # CLI 진입점
    ├── ui.py              # TUI 인터페이스
    ├── server.py          # 서버 정보 관리
    ├── ssh_client.py      # SSH 연결 관리
    ├── file_transfer.py   # 파일 전송 (SFTP)
    └── crypto.py          # 암호화 모듈
```

## 설정 파일 위치

```
~/.ssh_manager/
├── servers.json    # 서버 정보 (암호화됨)
└── .salt           # 암호화 솔트
```

## 보안 고려사항

1. **비밀번호 암호화**: AES-128-CBC (Fernet) 암호화 사용
2. **키 파생**: PBKDF2-HMAC-SHA256, 480,000 반복
3. **파일 권한**: 설정 파일은 소유자만 읽기/쓰기 가능 (600)
4. **메모리 보안**: 복호화된 비밀번호는 메모리에 잠시 존재

### 권장 사항

- 마스터 비밀번호는 충분히 길고 복잡하게 설정
- 공유 시스템에서는 사용 후 로그아웃
- 가능하면 SSH 키 인증 사용 권장 (향후 지원 예정)

## 문제 해결

### "연결 실패" 오류

1. 서버 IP/포트 확인
2. 방화벽 설정 확인 (포트 22 열려있는지)
3. SSH 서비스 실행 확인: `sudo systemctl status ssh`
4. 사용자명/비밀번호 확인

### "모듈을 찾을 수 없음" 오류

```bash
# 가상환경 활성화 확인
source venv/bin/activate

# 의존성 재설치
pip install -r requirements.txt
```

### 한글 깨짐

```bash
# 터미널 인코딩 설정
export LANG=ko_KR.UTF-8
export LC_ALL=ko_KR.UTF-8
```

## 향후 개발 예정

- [ ] SSH 키 인증 지원
- [ ] 서버 그룹별 작업
- [ ] 명령 히스토리
- [ ] 설정 내보내기/가져오기
- [ ] tmux 스타일 분할 화면

## 라이선스

MIT License

## Git Commit 메시지 추천

```
feat: SSH Manager 초기 구현

- 서버 정보 암호화 저장 기능 구현 (AES-128)
- 다중 SSH 연결 및 명령 브로드캐스트 기능
- SFTP 기반 파일 일괄 전송 기능
- rich 라이브러리 기반 TUI 인터페이스
- 마스터 비밀번호로 서버 정보 보호
```

